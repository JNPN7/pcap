// pub use self::datalink::*;
// mod datalink;
// pub mod anyname;
// pub use self::network::*;
// pub use self::network::protocols::Protocol;
// pub mod network;
// pub use self::transport::protocols::*;
// pub mod transport;
// pub mod packet;
// pub mod application;

mod anyname;
mod datalink;
mod network;
mod transport;
mod application;
mod packet;

pub use datalink::Datalink;
pub use network::{Network, NetworkType, protocols::Protocol};
pub use transport::{Transport, TransportType, protocols::Protocol as TProtocol}; // need new approach | both are protocol
pub use application::Application;
pub use anyname::ip::{IpAddr, Ipv4Addr, Ipv6Addr};
pub use anyname::mac::Mac;
pub use packet::Packet;

#[cfg(test)]
mod tests {
    use crate::{transport::Transport, packet::Packet};
    use super::*;

    #[test]
    fn it_works() {
        let result = 2 + 2;
        assert_eq!(result, 4);
    }


    #[test]
    fn datalink_layer() {
        let pac = [60, 145, 128, 146, 210, 3, 196, 72, 250, 144, 115, 64, 134, 221, 96, 1, 190, 164, 5, 152, 6, 60, 36, 0, 26, 0, 205, 17, 161, 19, 0, 0, 0, 0, 103, 211, 149, 152, 36, 0, 26, 0, 176, 32, 230, 156, 47, 47, 72, 219, 215, 182, 250, 92, 1, 187, 145, 54, 246, 35, 161, 11, 48, 85, 187, 90, 128, 16, 5, 129, 5, 38, 0, 0, 1, 1, 8, 10, 66, 184, 63, 101, 85, 79, 188, 33, 41, 155, 142, 19, 73, 40, 92, 14, 26, 42, 1, 25, 145, 162, 241, 44, 240, 9, 182, 121, 88, 2, 187, 111, 17, 240, 43, 244, 214, 22, 206, 221, 41, 76, 0, 29, 161, 10, 130, 187, 215, 44, 192, 91, 107, 92, 19, 56, 35, 87, 218, 125, 30, 6, 148, 236, 136, 19, 8, 138, 178, 112, 146, 26, 31, 32, 118, 251, 51, 230, 125, 9, 93, 130, 115, 148, 128, 52, 16, 113, 165, 26, 215, 85, 221, 81, 244, 58, 142, 127, 169, 162, 249, 31, 142, 247, 93, 66, 126, 7, 150, 249, 26, 187, 143, 218, 31, 129, 136, 61, 148, 221, 9, 213, 89, 5, 154, 206, 67, 27, 195, 180, 193, 27, 242, 190, 141, 171, 43, 201, 74, 147, 32, 107, 110, 10, 244, 55, 35, 121, 126, 223, 236, 13, 170, 194, 7, 208, 177, 60, 110, 189, 107, 188, 248, 74, 233, 138, 67, 10, 5, 128, 251, 50, 148, 48, 95, 241, 95, 240, 216, 107, 65, 0, 213, 185, 244, 7, 85, 30, 44, 72, 183, 255, 23, 153, 113, 27, 116, 59, 46, 239, 72, 5, 59, 55, 208, 177, 81, 107, 111, 254, 212, 1, 128, 67, 88, 177, 227, 160, 102, 113, 104, 111, 211, 150, 59, 58, 173, 4, 53, 43, 122, 156, 16, 15, 62, 176, 76, 191, 225, 76, 115, 189, 115, 127, 153, 154, 245, 46, 155, 178, 28, 183, 210, 112, 14, 114, 48, 110, 39, 210, 151, 155, 141, 105, 2, 178, 200, 235, 96, 24, 118, 210, 142, 241, 132, 50, 31, 116, 138, 201, 91, 85, 176, 148, 93, 35, 83, 26, 125, 253, 30, 112, 26, 1, 49, 5, 52, 22, 148, 106, 67, 84, 232, 2, 127, 201, 183, 211, 206, 153, 7, 78, 244, 207, 54, 82, 230, 33, 232, 116, 196, 205, 187, 178, 38, 17, 253, 15, 36, 172, 223, 233, 8, 203, 213, 192, 125, 209, 143, 0, 10, 44, 130, 222, 228, 194, 149, 168, 220, 98, 240, 222, 118, 220, 6, 85, 9, 113, 101, 12, 230, 229, 248, 150, 53, 106, 195, 134, 222, 2, 219, 59, 136, 91, 227, 60, 216, 94, 23, 173, 185, 223, 145, 147, 24, 227, 118, 84, 13, 79, 71, 71, 240, 206, 1, 32, 42, 105, 161, 30, 141, 68, 249, 237, 123, 18, 94, 68, 97, 175, 203, 183, 225, 64, 217, 127, 68, 43, 4, 203, 252, 42, 220, 230, 98, 187, 153, 242, 228, 224, 233, 204, 193, 86, 77, 172, 234, 160, 87, 166, 64, 118, 200, 163, 196, 148, 121, 98, 209, 41, 154, 183, 190, 155, 199, 119, 98, 12, 86, 165, 98, 235, 54, 9, 170, 105, 137, 185, 33, 122, 197, 194, 147, 192, 23, 10, 20, 178, 188, 62, 154, 34, 26, 96, 33, 173, 119, 177, 68, 143, 71, 46, 98, 199, 183, 183, 58, 110, 187, 74, 119, 42, 174, 179, 104, 202, 101, 101, 229, 122, 135, 24, 171, 67, 223, 145, 190, 58, 237, 89, 49, 156, 27, 78, 206, 250, 193, 187, 97, 96, 187, 100, 113, 226, 117, 188, 67, 206, 76, 63, 135, 81, 186, 154, 99, 95, 161, 30, 35, 1, 122, 17, 204, 244, 243, 220, 229, 202, 103, 165, 141, 221, 142, 116, 158, 143, 145, 65, 96, 161, 254, 75, 121, 182, 250, 227, 191, 153, 240, 203, 156, 130, 231, 179, 2, 35, 101, 129, 79, 234, 86, 131, 233, 7, 11, 167, 2, 105, 69, 15, 167, 117, 46, 59, 37, 197, 202, 226, 29, 100, 198, 54, 239, 77, 44, 176, 181, 97, 236, 240, 115, 133, 255, 220, 213, 80, 212, 87, 205, 12, 111, 249, 46, 227, 46, 34, 183, 232, 83, 66, 189, 0, 118, 21, 51, 14, 213, 236, 146, 238, 224, 102, 252, 32, 20, 114, 115, 13, 80, 224, 226, 125, 253, 242, 111, 187, 184, 40, 196, 159, 122, 252, 227, 248, 15, 81, 221, 157, 51, 203, 217, 192, 60, 196, 166, 245, 210, 193, 4, 64, 233, 81, 210, 196, 216, 157, 161, 43, 2, 36, 204, 252, 27, 230, 128, 64, 17, 3, 223, 21, 116, 153, 182, 182, 241, 231, 85, 231, 195, 94, 215, 69, 201, 114, 171, 112, 1, 143, 66, 159, 152, 3, 155, 126, 1, 100, 137, 127, 126, 33, 238, 115, 78, 36, 102, 128, 8, 218, 250, 99, 10, 49, 158, 205, 18, 169, 13, 179, 80, 17, 239, 20, 78, 29, 73, 103, 11, 252, 11, 223, 212, 125, 198, 149, 117, 208, 118, 72, 87, 161, 43, 238, 169, 27, 89, 193, 117, 148, 111, 251, 72, 242, 221, 216, 115, 51, 7, 65, 33, 208, 160, 196, 75, 208, 66, 160, 235, 198, 160, 107, 217, 199, 210, 185, 201, 122, 242, 206, 152, 158, 202, 178, 169, 33, 78, 118, 92, 87, 194, 54, 142, 161, 172, 100, 97, 185, 36, 162, 7, 203, 159, 38, 185, 109, 76, 76, 223, 71, 100, 178, 131, 93, 63, 168, 182, 180, 154, 244, 114, 131, 137, 134, 198, 106, 109, 105, 3, 21, 220, 22, 194, 57, 81, 70, 45, 210, 201, 180, 19, 8, 63, 91, 79, 47, 149, 254, 148, 29, 235, 247, 72, 99, 171, 254, 208, 205, 172, 119, 15, 158, 151, 198, 110, 249, 134, 131, 230, 120, 23, 175, 44, 149, 208, 87, 62, 206, 196, 141, 249, 131, 188, 227, 202, 8, 222, 22, 47, 219, 22, 112, 247, 199, 11, 221, 52, 11, 148, 212, 232, 13, 172, 119, 105, 68, 167, 78, 124, 254, 3, 93, 238, 174, 216, 50, 136, 101, 104, 118, 101, 38, 166, 113, 41, 112, 32, 104, 70, 26, 224, 144, 67, 244, 63, 79, 11, 91, 154, 43, 75, 97, 166, 193, 133, 0, 57, 49, 54, 145, 111, 74, 250, 129, 171, 252, 70, 6, 84, 175, 17, 119, 203, 228, 225, 215, 28, 10, 136, 243, 190, 27, 90, 147, 253, 2, 136, 100, 91, 238, 166, 168, 55, 215, 71, 158, 1, 168, 174, 61, 201, 20, 136, 2, 204, 250, 131, 205, 137, 12, 187, 106, 102, 225, 36, 118, 236, 189, 163, 71, 115, 1, 30, 203, 204, 83, 168, 56, 25, 89, 5, 84, 66, 196, 225, 159, 98, 234, 148, 249, 107, 213, 159, 148, 77, 207, 251, 149, 77, 126, 72, 100, 20, 241, 248, 47, 42, 229, 136, 52, 211, 128, 215, 246, 24, 135, 167, 143, 208, 105, 96, 160, 174, 124, 232, 182, 165, 176, 6, 204, 127, 126, 187, 242, 234, 130, 64, 113, 142, 98, 26, 99, 162, 67, 116, 226, 3, 196, 135, 244, 42, 146, 143, 234, 161, 88, 166, 229, 55, 20, 23, 90, 51, 104, 97, 51, 219, 42, 208, 73, 60, 193, 159, 200, 144, 75, 47, 174, 254, 95, 44, 162, 182, 96, 6, 16, 122, 85, 201, 218, 68, 197, 139, 248, 180, 84, 155, 21, 49, 85, 248, 113, 24, 206, 161, 0, 48, 37, 233, 216, 238, 118, 107, 110, 233, 177, 44, 67, 247, 223, 253, 5, 165, 95, 158, 187, 180, 220, 174, 221, 48, 192, 231, 78, 195, 144, 100, 201, 122, 97, 238, 148, 213, 121, 8, 164, 248, 220, 43, 61, 177, 61, 159, 167, 13, 230, 158, 119, 208, 51, 99, 164, 72, 149, 221, 209, 101, 86, 85, 193, 59, 220, 98, 117, 2, 88, 51, 34, 91, 18, 181, 214, 157, 78, 117, 140, 57, 84, 0, 69, 179, 175, 180, 160, 205, 178, 177, 200, 61, 73, 109, 29, 101, 191, 251, 135, 248, 210, 184, 149, 173, 194, 235, 237, 74, 80, 177, 69, 47, 207, 253, 103, 12, 138, 235, 100, 185, 18, 8, 179, 179, 246, 223, 6, 157, 99, 95, 193, 14, 13, 63, 41, 11, 91, 74, 178, 143, 69, 20, 230, 124, 69, 101, 125, 206, 238, 167, 102, 147, 223, 97, 118, 135, 153, 131, 137, 155, 16, 113, 109, 185, 169, 78, 220, 42, 79, 161, 154, 237, 57, 185, 234, 128, 10, 237, 70, 124, 58, 112, 144, 68, 138, 110, 177, 198, 110, 196, 185, 224, 110, 20, 109, 87, 3, 227, 83, 93, 124, 29, 87, 21, 175, 189, 240, 33, 4, 31, 146, 5, 254, 195, 10, 55, 97, 188, 29, 107, 212, 204, 72, 71, 206, 181, 211, 117, 70, 28, 205, 200, 120, 59, 11, 182, 68, 96, 55, 200, 82, 150, 122, 201, 224, 156, 202, 99, 113, 146, 76, 200, 181, 78, 2, 186, 49, 167, 233, 217, 160, 108, 50, 68, 3, 237, 157, 169, 160, 102, 166, 247, 154, 15, 140, 124, 70, 194, 230, 10, 109, 137, 83, 217, 214, 112, 111, 77, 120, 252, 0, 107, 79, 80, 82, 27, 0, 120, 94, 243, 142, 201, 79, 205, 87, 45, 201, 160, 9, 84, 148, 225, 159, 13, 54, 129, 220, 37, 173, 103, 163, 217, 20, 30, 221, 222, 93, 61, 146, 68, 250, 198, 17, 236, 111, 44, 113, 104, 178, 150, 89, 210, 104, 95, 97, 181, 37, 131, 21, 123, 22, 17, 9, 166, 133, 54, 133, 30, 220, 177, 125, 163, 1, 132, 200, 162, 142, 4, 90, 176, 123, 163, 54, 172, 21, 30, 181, 85, 253, 6, 181, 138, 153, 64, 200, 166, 157, 180, 0, 13, 61, 7, 36, 189, 110, 144, 125, 255, 7, 96, 117, 58, 85, 59, 205, 184, 1, 190, 126, 105, 251, 24, 144, 32, 90, 123, 179, 123, 183, 147, 99, 27, 232, 91, 167, 1, 95, 80, 171, 50, 52, 29, 139, 251, 196, 44, 239, 242, 165, 104, 90, 97, 95, 35, 244, 209, 103, 165, 211, 248, 138, 30, 139, 246, 144, 226, 209, 86, 143, 58, 75, 202, 180, 208, 186, 133, 30, 145, 220, 2, 187, 222, 111, 107, 17, 157, 113, 206, 50, 252, 177, 67, 249, 84, 12, 105, 3, 89, 9, 235, 107, 183, 177, 215, 27, 248, 100, 231, 193, 203, 128, 236, 133, 46, 185, 77, 89, 197, 51, 18, 91, 20, 7, 109, 110, 52, 170, 62, 189, 72, 23, 75, 143, 174, 156, 28, 65, 19, 237, 26, 54, 192, 167, 85, 227, 69, 19, 19, 133, 118, 125, 136, 112, 80, 104, 239, 25, 161, 125, 140, 103, 173, 86, 207, 164, 78, 212, 154, 152, 186, 242, 125, 90, 240, 238, 92, 87, 226, 174, 127, 127, 70, 159, 233, 45, 164, 144, 208, 33, 170, 53, 26, 221, 4, 72, 105, 207, 136, 186, 80, 160, 186, 147, 151, 131, 194, 55, 33, 21, 174, 196, 74, 35, 117, 176, 215, 7, 76, 19, 218, 219, 104, 183, 82, 29, 58, 41, 18, 209, 177, 116, 6, 204, 255, 210, 72, 160, 227, 167, 139, 21, 103, 179, 243, 94, 162, 26, 63, 4, 165, 207, 187, 188, 249, 62, 129, 123, 72, 59, 248, 77, 238, 191, 153, 176, 226, 19, 219, 188, 127, 53, 179, 91, 32, 158, 118, 138, 162, 27, 215, 146, 232, 150, 180, 165, 127, 124, 147, 9, 140, 59, 84, 37, 76, 159, 100, 152, 208, 148, 138, 116, 83, 71, 93, 115, 153, 213, 246, 18, 84, 53, 73, 165, 199, 43, 41, 85, 220, 246, 68, 150, 44, 153, 254, 124, 57, 203, 207, 251, 162, 204, 178, 253, 184, 183, 247, 54, 66, 69, 81, 232, 71, 76, 4, 54, 12, 123, 203, 195, 187, 86, 152, 13, 197, 2, 97, 53, 254, 176, 235, 15, 242, 119, 158, 55, 98, 205, 34, 202, 234, 252, 206, 59, 141, 38, 82, 230, 108, 160, 54, 123, 12, 45, 184, 147, 138, 126, 215, 90, 253, 225, 3, 77, 135, 67];
        let datalink_layer = Datalink::new(&pac[..14]);

        assert_eq!(datalink_layer.srcmac(), [60, 145, 128, 146, 210, 3]);
        assert_eq!(datalink_layer.dstmac(), [196, 72, 250, 144, 115, 64]);
        // assert_eq!(Type::IPV4, Type::IPV6);
    }

    #[test]
    fn transport_layer() {
        // ipv6
        // let pac = [60, 145, 128, 146, 210, 3, 196, 72, 250, 144, 115, 64, 134, 221, 96, 1, 190, 164, 5, 152, 6, 60, 36, 0, 26, 0, 205, 17, 161, 19, 0, 0, 0, 0, 103, 211, 149, 152, 36, 0, 26, 0, 176, 32, 230, 156, 47, 47, 72, 219, 215, 182, 250, 92, 1, 187, 145, 54, 246, 35, 161, 11, 48, 85, 187, 90, 128, 16, 5, 129, 5, 38, 0, 0, 1, 1, 8, 10, 66, 184, 63, 101, 85, 79, 188, 33, 41, 155, 142, 19, 73, 40, 92, 14, 26, 42, 1, 25, 145, 162, 241, 44, 240, 9, 182, 121, 88, 2, 187, 111, 17, 240, 43, 244, 214, 22, 206, 221, 41, 76, 0, 29, 161, 10, 130, 187, 215, 44, 192, 91, 107, 92, 19, 56, 35, 87, 218, 125, 30, 6, 148, 236, 136, 19, 8, 138, 178, 112, 146, 26, 31, 32, 118, 251, 51, 230, 125, 9, 93, 130, 115, 148, 128, 52, 16, 113, 165, 26, 215, 85, 221, 81, 244, 58, 142, 127, 169, 162, 249, 31, 142, 247, 93, 66, 126, 7, 150, 249, 26, 187, 143, 218, 31, 129, 136, 61, 148, 221, 9, 213, 89, 5, 154, 206, 67, 27, 195, 180, 193, 27, 242, 190, 141, 171, 43, 201, 74, 147, 32, 107, 110, 10, 244, 55, 35, 121, 126, 223, 236, 13, 170, 194, 7, 208, 177, 60, 110, 189, 107, 188, 248, 74, 233, 138, 67, 10, 5, 128, 251, 50, 148, 48, 95, 241, 95, 240, 216, 107, 65, 0, 213, 185, 244, 7, 85, 30, 44, 72, 183, 255, 23, 153, 113, 27, 116, 59, 46, 239, 72, 5, 59, 55, 208, 177, 81, 107, 111, 254, 212, 1, 128, 67, 88, 177, 227, 160, 102, 113, 104, 111, 211, 150, 59, 58, 173, 4, 53, 43, 122, 156, 16, 15, 62, 176, 76, 191, 225, 76, 115, 189, 115, 127, 153, 154, 245, 46, 155, 178, 28, 183, 210, 112, 14, 114, 48, 110, 39, 210, 151, 155, 141, 105, 2, 178, 200, 235, 96, 24, 118, 210, 142, 241, 132, 50, 31, 116, 138, 201, 91, 85, 176, 148, 93, 35, 83, 26, 125, 253, 30, 112, 26, 1, 49, 5, 52, 22, 148, 106, 67, 84, 232, 2, 127, 201, 183, 211, 206, 153, 7, 78, 244, 207, 54, 82, 230, 33, 232, 116, 196, 205, 187, 178, 38, 17, 253, 15, 36, 172, 223, 233, 8, 203, 213, 192, 125, 209, 143, 0, 10, 44, 130, 222, 228, 194, 149, 168, 220, 98, 240, 222, 118, 220, 6, 85, 9, 113, 101, 12, 230, 229, 248, 150, 53, 106, 195, 134, 222, 2, 219, 59, 136, 91, 227, 60, 216, 94, 23, 173, 185, 223, 145, 147, 24, 227, 118, 84, 13, 79, 71, 71, 240, 206, 1, 32, 42, 105, 161, 30, 141, 68, 249, 237, 123, 18, 94, 68, 97, 175, 203, 183, 225, 64, 217, 127, 68, 43, 4, 203, 252, 42, 220, 230, 98, 187, 153, 242, 228, 224, 233, 204, 193, 86, 77, 172, 234, 160, 87, 166, 64, 118, 200, 163, 196, 148, 121, 98, 209, 41, 154, 183, 190, 155, 199, 119, 98, 12, 86, 165, 98, 235, 54, 9, 170, 105, 137, 185, 33, 122, 197, 194, 147, 192, 23, 10, 20, 178, 188, 62, 154, 34, 26, 96, 33, 173, 119, 177, 68, 143, 71, 46, 98, 199, 183, 183, 58, 110, 187, 74, 119, 42, 174, 179, 104, 202, 101, 101, 229, 122, 135, 24, 171, 67, 223, 145, 190, 58, 237, 89, 49, 156, 27, 78, 206, 250, 193, 187, 97, 96, 187, 100, 113, 226, 117, 188, 67, 206, 76, 63, 135, 81, 186, 154, 99, 95, 161, 30, 35, 1, 122, 17, 204, 244, 243, 220, 229, 202, 103, 165, 141, 221, 142, 116, 158, 143, 145, 65, 96, 161, 254, 75, 121, 182, 250, 227, 191, 153, 240, 203, 156, 130, 231, 179, 2, 35, 101, 129, 79, 234, 86, 131, 233, 7, 11, 167, 2, 105, 69, 15, 167, 117, 46, 59, 37, 197, 202, 226, 29, 100, 198, 54, 239, 77, 44, 176, 181, 97, 236, 240, 115, 133, 255, 220, 213, 80, 212, 87, 205, 12, 111, 249, 46, 227, 46, 34, 183, 232, 83, 66, 189, 0, 118, 21, 51, 14, 213, 236, 146, 238, 224, 102, 252, 32, 20, 114, 115, 13, 80, 224, 226, 125, 253, 242, 111, 187, 184, 40, 196, 159, 122, 252, 227, 248, 15, 81, 221, 157, 51, 203, 217, 192, 60, 196, 166, 245, 210, 193, 4, 64, 233, 81, 210, 196, 216, 157, 161, 43, 2, 36, 204, 252, 27, 230, 128, 64, 17, 3, 223, 21, 116, 153, 182, 182, 241, 231, 85, 231, 195, 94, 215, 69, 201, 114, 171, 112, 1, 143, 66, 159, 152, 3, 155, 126, 1, 100, 137, 127, 126, 33, 238, 115, 78, 36, 102, 128, 8, 218, 250, 99, 10, 49, 158, 205, 18, 169, 13, 179, 80, 17, 239, 20, 78, 29, 73, 103, 11, 252, 11, 223, 212, 125, 198, 149, 117, 208, 118, 72, 87, 161, 43, 238, 169, 27, 89, 193, 117, 148, 111, 251, 72, 242, 221, 216, 115, 51, 7, 65, 33, 208, 160, 196, 75, 208, 66, 160, 235, 198, 160, 107, 217, 199, 210, 185, 201, 122, 242, 206, 152, 158, 202, 178, 169, 33, 78, 118, 92, 87, 194, 54, 142, 161, 172, 100, 97, 185, 36, 162, 7, 203, 159, 38, 185, 109, 76, 76, 223, 71, 100, 178, 131, 93, 63, 168, 182, 180, 154, 244, 114, 131, 137, 134, 198, 106, 109, 105, 3, 21, 220, 22, 194, 57, 81, 70, 45, 210, 201, 180, 19, 8, 63, 91, 79, 47, 149, 254, 148, 29, 235, 247, 72, 99, 171, 254, 208, 205, 172, 119, 15, 158, 151, 198, 110, 249, 134, 131, 230, 120, 23, 175, 44, 149, 208, 87, 62, 206, 196, 141, 249, 131, 188, 227, 202, 8, 222, 22, 47, 219, 22, 112, 247, 199, 11, 221, 52, 11, 148, 212, 232, 13, 172, 119, 105, 68, 167, 78, 124, 254, 3, 93, 238, 174, 216, 50, 136, 101, 104, 118, 101, 38, 166, 113, 41, 112, 32, 104, 70, 26, 224, 144, 67, 244, 63, 79, 11, 91, 154, 43, 75, 97, 166, 193, 133, 0, 57, 49, 54, 145, 111, 74, 250, 129, 171, 252, 70, 6, 84, 175, 17, 119, 203, 228, 225, 215, 28, 10, 136, 243, 190, 27, 90, 147, 253, 2, 136, 100, 91, 238, 166, 168, 55, 215, 71, 158, 1, 168, 174, 61, 201, 20, 136, 2, 204, 250, 131, 205, 137, 12, 187, 106, 102, 225, 36, 118, 236, 189, 163, 71, 115, 1, 30, 203, 204, 83, 168, 56, 25, 89, 5, 84, 66, 196, 225, 159, 98, 234, 148, 249, 107, 213, 159, 148, 77, 207, 251, 149, 77, 126, 72, 100, 20, 241, 248, 47, 42, 229, 136, 52, 211, 128, 215, 246, 24, 135, 167, 143, 208, 105, 96, 160, 174, 124, 232, 182, 165, 176, 6, 204, 127, 126, 187, 242, 234, 130, 64, 113, 142, 98, 26, 99, 162, 67, 116, 226, 3, 196, 135, 244, 42, 146, 143, 234, 161, 88, 166, 229, 55, 20, 23, 90, 51, 104, 97, 51, 219, 42, 208, 73, 60, 193, 159, 200, 144, 75, 47, 174, 254, 95, 44, 162, 182, 96, 6, 16, 122, 85, 201, 218, 68, 197, 139, 248, 180, 84, 155, 21, 49, 85, 248, 113, 24, 206, 161, 0, 48, 37, 233, 216, 238, 118, 107, 110, 233, 177, 44, 67, 247, 223, 253, 5, 165, 95, 158, 187, 180, 220, 174, 221, 48, 192, 231, 78, 195, 144, 100, 201, 122, 97, 238, 148, 213, 121, 8, 164, 248, 220, 43, 61, 177, 61, 159, 167, 13, 230, 158, 119, 208, 51, 99, 164, 72, 149, 221, 209, 101, 86, 85, 193, 59, 220, 98, 117, 2, 88, 51, 34, 91, 18, 181, 214, 157, 78, 117, 140, 57, 84, 0, 69, 179, 175, 180, 160, 205, 178, 177, 200, 61, 73, 109, 29, 101, 191, 251, 135, 248, 210, 184, 149, 173, 194, 235, 237, 74, 80, 177, 69, 47, 207, 253, 103, 12, 138, 235, 100, 185, 18, 8, 179, 179, 246, 223, 6, 157, 99, 95, 193, 14, 13, 63, 41, 11, 91, 74, 178, 143, 69, 20, 230, 124, 69, 101, 125, 206, 238, 167, 102, 147, 223, 97, 118, 135, 153, 131, 137, 155, 16, 113, 109, 185, 169, 78, 220, 42, 79, 161, 154, 237, 57, 185, 234, 128, 10, 237, 70, 124, 58, 112, 144, 68, 138, 110, 177, 198, 110, 196, 185, 224, 110, 20, 109, 87, 3, 227, 83, 93, 124, 29, 87, 21, 175, 189, 240, 33, 4, 31, 146, 5, 254, 195, 10, 55, 97, 188, 29, 107, 212, 204, 72, 71, 206, 181, 211, 117, 70, 28, 205, 200, 120, 59, 11, 182, 68, 96, 55, 200, 82, 150, 122, 201, 224, 156, 202, 99, 113, 146, 76, 200, 181, 78, 2, 186, 49, 167, 233, 217, 160, 108, 50, 68, 3, 237, 157, 169, 160, 102, 166, 247, 154, 15, 140, 124, 70, 194, 230, 10, 109, 137, 83, 217, 214, 112, 111, 77, 120, 252, 0, 107, 79, 80, 82, 27, 0, 120, 94, 243, 142, 201, 79, 205, 87, 45, 201, 160, 9, 84, 148, 225, 159, 13, 54, 129, 220, 37, 173, 103, 163, 217, 20, 30, 221, 222, 93, 61, 146, 68, 250, 198, 17, 236, 111, 44, 113, 104, 178, 150, 89, 210, 104, 95, 97, 181, 37, 131, 21, 123, 22, 17, 9, 166, 133, 54, 133, 30, 220, 177, 125, 163, 1, 132, 200, 162, 142, 4, 90, 176, 123, 163, 54, 172, 21, 30, 181, 85, 253, 6, 181, 138, 153, 64, 200, 166, 157, 180, 0, 13, 61, 7, 36, 189, 110, 144, 125, 255, 7, 96, 117, 58, 85, 59, 205, 184, 1, 190, 126, 105, 251, 24, 144, 32, 90, 123, 179, 123, 183, 147, 99, 27, 232, 91, 167, 1, 95, 80, 171, 50, 52, 29, 139, 251, 196, 44, 239, 242, 165, 104, 90, 97, 95, 35, 244, 209, 103, 165, 211, 248, 138, 30, 139, 246, 144, 226, 209, 86, 143, 58, 75, 202, 180, 208, 186, 133, 30, 145, 220, 2, 187, 222, 111, 107, 17, 157, 113, 206, 50, 252, 177, 67, 249, 84, 12, 105, 3, 89, 9, 235, 107, 183, 177, 215, 27, 248, 100, 231, 193, 203, 128, 236, 133, 46, 185, 77, 89, 197, 51, 18, 91, 20, 7, 109, 110, 52, 170, 62, 189, 72, 23, 75, 143, 174, 156, 28, 65, 19, 237, 26, 54, 192, 167, 85, 227, 69, 19, 19, 133, 118, 125, 136, 112, 80, 104, 239, 25, 161, 125, 140, 103, 173, 86, 207, 164, 78, 212, 154, 152, 186, 242, 125, 90, 240, 238, 92, 87, 226, 174, 127, 127, 70, 159, 233, 45, 164, 144, 208, 33, 170, 53, 26, 221, 4, 72, 105, 207, 136, 186, 80, 160, 186, 147, 151, 131, 194, 55, 33, 21, 174, 196, 74, 35, 117, 176, 215, 7, 76, 19, 218, 219, 104, 183, 82, 29, 58, 41, 18, 209, 177, 116, 6, 204, 255, 210, 72, 160, 227, 167, 139, 21, 103, 179, 243, 94, 162, 26, 63, 4, 165, 207, 187, 188, 249, 62, 129, 123, 72, 59, 248, 77, 238, 191, 153, 176, 226, 19, 219, 188, 127, 53, 179, 91, 32, 158, 118, 138, 162, 27, 215, 146, 232, 150, 180, 165, 127, 124, 147, 9, 140, 59, 84, 37, 76, 159, 100, 152, 208, 148, 138, 116, 83, 71, 93, 115, 153, 213, 246, 18, 84, 53, 73, 165, 199, 43, 41, 85, 220, 246, 68, 150, 44, 153, 254, 124, 57, 203, 207, 251, 162, 204, 178, 253, 184, 183, 247, 54, 66, 69, 81, 232, 71, 76, 4, 54, 12, 123, 203, 195, 187, 86, 152, 13, 197, 2, 97, 53, 254, 176, 235, 15, 242, 119, 158, 55, 98, 205, 34, 202, 234, 252, 206, 59, 141, 38, 82, 230, 108, 160, 54, 123, 12, 45, 184, 147, 138, 126, 215, 90, 253, 225, 3, 77, 135, 67];
        // ipv4
        let pac = [196, 72, 250, 144, 115, 64, 60, 145, 128, 146, 210, 3, 8, 0, 69, 0, 0, 0, 0, 24, 58, 200, 36, 6, 26, 0, 176, 32, 230, 156, 47, 47, 72, 219, 215, 182, 250, 92, 36, 0, 26, 0, 176, 32, 230, 156, 0, 10, 0, 0, 0, 0, 0, 1, 136, 0, 37, 54, 64, 0, 0, 0, 36, 0, 26, 0, 176, 32, 230, 156, 47, 47, 72, 219, 215, 182, 250, 92, 1, 1, 196, 72, 250, 144, 115, 64, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
        // arp
        
        // println!("length: {}", pac.len());

        let datalink_layer = Datalink::new(&pac[..14]);

        // let protocol = match &datalink_layer.typ() {
        //     TypE::Arp => arp::Arp::new(&pac[14..42]),
        //     Type::Ipv4 => ipv4::Ipv4::new(&pac[14..34]),
        //     Type::Ipv6 => ipv6::Ipv6::new(&pac[14..54]),
        //     _ => panic!("Protocol selection")
        // };

        let network = Network::new(&pac[14..], datalink_layer.typ());
       
        // match datalink_layer.typ() {
        //     Type::Arp => {println!("somesome")}
        //     Type::Ipv4 => {println!("ipv4 ipv4")}
        //     Type::Ipv6 => {
        //         println!("ipv6 ipv6");
        //         let protcol = network.protocol; 
        //     }
        //     _ => {}
        // }

        match network.protocol() {
            Protocol::Arp(arp) => {
                println!("dome");
                println!("{:?}", arp.hardware_type());
            },
            Protocol::Ipv4(ipv4) => {
                println!("{:?}", ipv4.checksum());
                let ihl = ipv4.ihl();
                println!("header_len: {:x}", ipv4.header_len());
                println!("version: {}", ipv4.version());

                println!("ihl: {:?}", ihl);
                let end = ihl * 4 + 14;
                println!("end: {:?}", end);

                println!("ecn: {}", ipv4.ecn());
                println!("ecn: {}", ipv4.ecn());
                println!("ecn: {}", ipv4.ecn());
                // let transport = Trasport::new();
                let transport = Transport::new(&pac, ipv4.protocol());

                match transport.protocol() {
                    transport::protocols::Protocol::Tcp(tcp) => {
                        println!("tcp ack no: {}",tcp.ack_no());
                        println!("flag: {:b}",tcp.flag());
                        tcp.nonce();
                    },
                    transport::protocols::Protocol::Icmp(icmp) => {
                        println!("{}", icmp.checksum());
                        todo!()
                    },
                    transport::protocols::Protocol::Icmpv6(icmpv6) => {
                        println!("{}", icmpv6.checksum());
                        todo!()
                    },
                    transport::protocols::Protocol::Udp(udp) => {
                        println!("{}", udp.src_port());
                        todo!()
                    }
                }
                
            },
            Protocol::Ipv6(ipv6) => {
                println!("ipv6");
                println!("{:?}", ipv6.hop_limit());
            },
            // _ => {println!("not worked")}
        }
    }

    #[test]
    fn packet() {
        let pac = [60, 145, 128, 146, 210, 3, 196, 72, 250, 144, 115, 64, 134, 221, 96, 1, 190, 164, 5, 152, 6, 60, 36, 0, 26, 0, 205, 17, 161, 19, 0, 0, 0, 0, 103, 211, 149, 152, 36, 0, 26, 0, 176, 32, 230, 156, 47, 47, 72, 219, 215, 182, 250, 92, 1, 187, 145, 54, 246, 35, 161, 11, 48, 85, 187, 90, 128, 16, 5, 129, 5, 38, 0, 0, 1, 1, 8, 10, 66, 184, 63, 101, 85, 79, 188, 33, 41, 155, 142, 19, 73, 40, 92, 14, 26, 42, 1, 25, 145, 162, 241, 44, 240, 9, 182, 121, 88, 2, 187, 111, 17, 240, 43, 244, 214, 22, 206, 221, 41, 76, 0, 29, 161, 10, 130, 187, 215, 44, 192, 91, 107, 92, 19, 56, 35, 87, 218, 125, 30, 6, 148, 236, 136, 19, 8, 138, 178, 112, 146, 26, 31, 32, 118, 251, 51, 230, 125, 9, 93, 130, 115, 148, 128, 52, 16, 113, 165, 26, 215, 85, 221, 81, 244, 58, 142, 127, 169, 162, 249, 31, 142, 247, 93, 66, 126, 7, 150, 249, 26, 187, 143, 218, 31, 129, 136, 61, 148, 221, 9, 213, 89, 5, 154, 206, 67, 27, 195, 180, 193, 27, 242, 190, 141, 171, 43, 201, 74, 147, 32, 107, 110, 10, 244, 55, 35, 121, 126, 223, 236, 13, 170, 194, 7, 208, 177, 60, 110, 189, 107, 188, 248, 74, 233, 138, 67, 10, 5, 128, 251, 50, 148, 48, 95, 241, 95, 240, 216, 107, 65, 0, 213, 185, 244, 7, 85, 30, 44, 72, 183, 255, 23, 153, 113, 27, 116, 59, 46, 239, 72, 5, 59, 55, 208, 177, 81, 107, 111, 254, 212, 1, 128, 67, 88, 177, 227, 160, 102, 113, 104, 111, 211, 150, 59, 58, 173, 4, 53, 43, 122, 156, 16, 15, 62, 176, 76, 191, 225, 76, 115, 189, 115, 127, 153, 154, 245, 46, 155, 178, 28, 183, 210, 112, 14, 114, 48, 110, 39, 210, 151, 155, 141, 105, 2, 178, 200, 235, 96, 24, 118, 210, 142, 241, 132, 50, 31, 116, 138, 201, 91, 85, 176, 148, 93, 35, 83, 26, 125, 253, 30, 112, 26, 1, 49, 5, 52, 22, 148, 106, 67, 84, 232, 2, 127, 201, 183, 211, 206, 153, 7, 78, 244, 207, 54, 82, 230, 33, 232, 116, 196, 205, 187, 178, 38, 17, 253, 15, 36, 172, 223, 233, 8, 203, 213, 192, 125, 209, 143, 0, 10, 44, 130, 222, 228, 194, 149, 168, 220, 98, 240, 222, 118, 220, 6, 85, 9, 113, 101, 12, 230, 229, 248, 150, 53, 106, 195, 134, 222, 2, 219, 59, 136, 91, 227, 60, 216, 94, 23, 173, 185, 223, 145, 147, 24, 227, 118, 84, 13, 79, 71, 71, 240, 206, 1, 32, 42, 105, 161, 30, 141, 68, 249, 237, 123, 18, 94, 68, 97, 175, 203, 183, 225, 64, 217, 127, 68, 43, 4, 203, 252, 42, 220, 230, 98, 187, 153, 242, 228, 224, 233, 204, 193, 86, 77, 172, 234, 160, 87, 166, 64, 118, 200, 163, 196, 148, 121, 98, 209, 41, 154, 183, 190, 155, 199, 119, 98, 12, 86, 165, 98, 235, 54, 9, 170, 105, 137, 185, 33, 122, 197, 194, 147, 192, 23, 10, 20, 178, 188, 62, 154, 34, 26, 96, 33, 173, 119, 177, 68, 143, 71, 46, 98, 199, 183, 183, 58, 110, 187, 74, 119, 42, 174, 179, 104, 202, 101, 101, 229, 122, 135, 24, 171, 67, 223, 145, 190, 58, 237, 89, 49, 156, 27, 78, 206, 250, 193, 187, 97, 96, 187, 100, 113, 226, 117, 188, 67, 206, 76, 63, 135, 81, 186, 154, 99, 95, 161, 30, 35, 1, 122, 17, 204, 244, 243, 220, 229, 202, 103, 165, 141, 221, 142, 116, 158, 143, 145, 65, 96, 161, 254, 75, 121, 182, 250, 227, 191, 153, 240, 203, 156, 130, 231, 179, 2, 35, 101, 129, 79, 234, 86, 131, 233, 7, 11, 167, 2, 105, 69, 15, 167, 117, 46, 59, 37, 197, 202, 226, 29, 100, 198, 54, 239, 77, 44, 176, 181, 97, 236, 240, 115, 133, 255, 220, 213, 80, 212, 87, 205, 12, 111, 249, 46, 227, 46, 34, 183, 232, 83, 66, 189, 0, 118, 21, 51, 14, 213, 236, 146, 238, 224, 102, 252, 32, 20, 114, 115, 13, 80, 224, 226, 125, 253, 242, 111, 187, 184, 40, 196, 159, 122, 252, 227, 248, 15, 81, 221, 157, 51, 203, 217, 192, 60, 196, 166, 245, 210, 193, 4, 64, 233, 81, 210, 196, 216, 157, 161, 43, 2, 36, 204, 252, 27, 230, 128, 64, 17, 3, 223, 21, 116, 153, 182, 182, 241, 231, 85, 231, 195, 94, 215, 69, 201, 114, 171, 112, 1, 143, 66, 159, 152, 3, 155, 126, 1, 100, 137, 127, 126, 33, 238, 115, 78, 36, 102, 128, 8, 218, 250, 99, 10, 49, 158, 205, 18, 169, 13, 179, 80, 17, 239, 20, 78, 29, 73, 103, 11, 252, 11, 223, 212, 125, 198, 149, 117, 208, 118, 72, 87, 161, 43, 238, 169, 27, 89, 193, 117, 148, 111, 251, 72, 242, 221, 216, 115, 51, 7, 65, 33, 208, 160, 196, 75, 208, 66, 160, 235, 198, 160, 107, 217, 199, 210, 185, 201, 122, 242, 206, 152, 158, 202, 178, 169, 33, 78, 118, 92, 87, 194, 54, 142, 161, 172, 100, 97, 185, 36, 162, 7, 203, 159, 38, 185, 109, 76, 76, 223, 71, 100, 178, 131, 93, 63, 168, 182, 180, 154, 244, 114, 131, 137, 134, 198, 106, 109, 105, 3, 21, 220, 22, 194, 57, 81, 70, 45, 210, 201, 180, 19, 8, 63, 91, 79, 47, 149, 254, 148, 29, 235, 247, 72, 99, 171, 254, 208, 205, 172, 119, 15, 158, 151, 198, 110, 249, 134, 131, 230, 120, 23, 175, 44, 149, 208, 87, 62, 206, 196, 141, 249, 131, 188, 227, 202, 8, 222, 22, 47, 219, 22, 112, 247, 199, 11, 221, 52, 11, 148, 212, 232, 13, 172, 119, 105, 68, 167, 78, 124, 254, 3, 93, 238, 174, 216, 50, 136, 101, 104, 118, 101, 38, 166, 113, 41, 112, 32, 104, 70, 26, 224, 144, 67, 244, 63, 79, 11, 91, 154, 43, 75, 97, 166, 193, 133, 0, 57, 49, 54, 145, 111, 74, 250, 129, 171, 252, 70, 6, 84, 175, 17, 119, 203, 228, 225, 215, 28, 10, 136, 243, 190, 27, 90, 147, 253, 2, 136, 100, 91, 238, 166, 168, 55, 215, 71, 158, 1, 168, 174, 61, 201, 20, 136, 2, 204, 250, 131, 205, 137, 12, 187, 106, 102, 225, 36, 118, 236, 189, 163, 71, 115, 1, 30, 203, 204, 83, 168, 56, 25, 89, 5, 84, 66, 196, 225, 159, 98, 234, 148, 249, 107, 213, 159, 148, 77, 207, 251, 149, 77, 126, 72, 100, 20, 241, 248, 47, 42, 229, 136, 52, 211, 128, 215, 246, 24, 135, 167, 143, 208, 105, 96, 160, 174, 124, 232, 182, 165, 176, 6, 204, 127, 126, 187, 242, 234, 130, 64, 113, 142, 98, 26, 99, 162, 67, 116, 226, 3, 196, 135, 244, 42, 146, 143, 234, 161, 88, 166, 229, 55, 20, 23, 90, 51, 104, 97, 51, 219, 42, 208, 73, 60, 193, 159, 200, 144, 75, 47, 174, 254, 95, 44, 162, 182, 96, 6, 16, 122, 85, 201, 218, 68, 197, 139, 248, 180, 84, 155, 21, 49, 85, 248, 113, 24, 206, 161, 0, 48, 37, 233, 216, 238, 118, 107, 110, 233, 177, 44, 67, 247, 223, 253, 5, 165, 95, 158, 187, 180, 220, 174, 221, 48, 192, 231, 78, 195, 144, 100, 201, 122, 97, 238, 148, 213, 121, 8, 164, 248, 220, 43, 61, 177, 61, 159, 167, 13, 230, 158, 119, 208, 51, 99, 164, 72, 149, 221, 209, 101, 86, 85, 193, 59, 220, 98, 117, 2, 88, 51, 34, 91, 18, 181, 214, 157, 78, 117, 140, 57, 84, 0, 69, 179, 175, 180, 160, 205, 178, 177, 200, 61, 73, 109, 29, 101, 191, 251, 135, 248, 210, 184, 149, 173, 194, 235, 237, 74, 80, 177, 69, 47, 207, 253, 103, 12, 138, 235, 100, 185, 18, 8, 179, 179, 246, 223, 6, 157, 99, 95, 193, 14, 13, 63, 41, 11, 91, 74, 178, 143, 69, 20, 230, 124, 69, 101, 125, 206, 238, 167, 102, 147, 223, 97, 118, 135, 153, 131, 137, 155, 16, 113, 109, 185, 169, 78, 220, 42, 79, 161, 154, 237, 57, 185, 234, 128, 10, 237, 70, 124, 58, 112, 144, 68, 138, 110, 177, 198, 110, 196, 185, 224, 110, 20, 109, 87, 3, 227, 83, 93, 124, 29, 87, 21, 175, 189, 240, 33, 4, 31, 146, 5, 254, 195, 10, 55, 97, 188, 29, 107, 212, 204, 72, 71, 206, 181, 211, 117, 70, 28, 205, 200, 120, 59, 11, 182, 68, 96, 55, 200, 82, 150, 122, 201, 224, 156, 202, 99, 113, 146, 76, 200, 181, 78, 2, 186, 49, 167, 233, 217, 160, 108, 50, 68, 3, 237, 157, 169, 160, 102, 166, 247, 154, 15, 140, 124, 70, 194, 230, 10, 109, 137, 83, 217, 214, 112, 111, 77, 120, 252, 0, 107, 79, 80, 82, 27, 0, 120, 94, 243, 142, 201, 79, 205, 87, 45, 201, 160, 9, 84, 148, 225, 159, 13, 54, 129, 220, 37, 173, 103, 163, 217, 20, 30, 221, 222, 93, 61, 146, 68, 250, 198, 17, 236, 111, 44, 113, 104, 178, 150, 89, 210, 104, 95, 97, 181, 37, 131, 21, 123, 22, 17, 9, 166, 133, 54, 133, 30, 220, 177, 125, 163, 1, 132, 200, 162, 142, 4, 90, 176, 123, 163, 54, 172, 21, 30, 181, 85, 253, 6, 181, 138, 153, 64, 200, 166, 157, 180, 0, 13, 61, 7, 36, 189, 110, 144, 125, 255, 7, 96, 117, 58, 85, 59, 205, 184, 1, 190, 126, 105, 251, 24, 144, 32, 90, 123, 179, 123, 183, 147, 99, 27, 232, 91, 167, 1, 95, 80, 171, 50, 52, 29, 139, 251, 196, 44, 239, 242, 165, 104, 90, 97, 95, 35, 244, 209, 103, 165, 211, 248, 138, 30, 139, 246, 144, 226, 209, 86, 143, 58, 75, 202, 180, 208, 186, 133, 30, 145, 220, 2, 187, 222, 111, 107, 17, 157, 113, 206, 50, 252, 177, 67, 249, 84, 12, 105, 3, 89, 9, 235, 107, 183, 177, 215, 27, 248, 100, 231, 193, 203, 128, 236, 133, 46, 185, 77, 89, 197, 51, 18, 91, 20, 7, 109, 110, 52, 170, 62, 189, 72, 23, 75, 143, 174, 156, 28, 65, 19, 237, 26, 54, 192, 167, 85, 227, 69, 19, 19, 133, 118, 125, 136, 112, 80, 104, 239, 25, 161, 125, 140, 103, 173, 86, 207, 164, 78, 212, 154, 152, 186, 242, 125, 90, 240, 238, 92, 87, 226, 174, 127, 127, 70, 159, 233, 45, 164, 144, 208, 33, 170, 53, 26, 221, 4, 72, 105, 207, 136, 186, 80, 160, 186, 147, 151, 131, 194, 55, 33, 21, 174, 196, 74, 35, 117, 176, 215, 7, 76, 19, 218, 219, 104, 183, 82, 29, 58, 41, 18, 209, 177, 116, 6, 204, 255, 210, 72, 160, 227, 167, 139, 21, 103, 179, 243, 94, 162, 26, 63, 4, 165, 207, 187, 188, 249, 62, 129, 123, 72, 59, 248, 77, 238, 191, 153, 176, 226, 19, 219, 188, 127, 53, 179, 91, 32, 158, 118, 138, 162, 27, 215, 146, 232, 150, 180, 165, 127, 124, 147, 9, 140, 59, 84, 37, 76, 159, 100, 152, 208, 148, 138, 116, 83, 71, 93, 115, 153, 213, 246, 18, 84, 53, 73, 165, 199, 43, 41, 85, 220, 246, 68, 150, 44, 153, 254, 124, 57, 203, 207, 251, 162, 204, 178, 253, 184, 183, 247, 54, 66, 69, 81, 232, 71, 76, 4, 54, 12, 123, 203, 195, 187, 86, 152, 13, 197, 2, 97, 53, 254, 176, 235, 15, 242, 119, 158, 55, 98, 205, 34, 202, 234, 252, 206, 59, 141, 38, 82, 230, 108, 160, 54, 123, 12, 45, 184, 147, 138, 126, 215, 90, 253, 225, 3, 77, 135, 67];

        let packet = Packet::new(&pac);

        println!("network protocol: {}", packet.network().protocol_string());
    }
}